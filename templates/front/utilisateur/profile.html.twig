{% extends 'bases.html.twig' %}

{% block title %}Utilisateur index
{% endblock %}

{% block main %}

	<div class="d-flex justify-content-end mt-3">
		<a class="btn btn-danger ml-auto" href="{{ path('app_logout') }}">Me deconnecter</a>
	</div>
	<h1 class="px-4 pb-2 border-bottom">Welcome
		{{ app.user.prenom }}
		{{ app.user.nom }}</h1>


	{% if app.user.livres.count == 0 %}
		<h3 class="my-5">Vous n'avez pas encore de livre(s) Ã  revendre</h3>
	{% else %}
		<section class="my-4">

			<div class="d-flex flex-wrap justify-content-around">

				{% for livre in app.user.livres %}
					<div class="card mb-4 text-center" style="width: 18rem;">
						{% include 'cardBase.html.twig' %}
					</div>
				{% endfor %}
			</div>
		</section>

		<br>
		<h2>
			<a href="{{ path('command_index') }}">Mes commandes</a>
		</h2>

	{% endif %}

	<section class="my-4">
		{% if app.user.commands.count == 0 %}
			<h3 class="my-5">Vous n'avez pas encore achetÃ© de livre(s)</h3>

		{% else %}
			<section class="my-4">
				{% for command in app.user.commands %}
					<div class="border border-success">
						<h3>ID de command :
							{{ command.id }}</h3>
						<div class="d-flex flex-wrap justify-content-around ">
							{% for produit in command.produits %}
								<div class="card mb-4 text-center" style="width: 18rem;">
									<div class="card-body">
										<h2 class="card-title">{{ produit.titre }}</h2>
										<h3 class="card-text">
											<a href="{{ path('front_auteur_show', {'id' : produit.auteur.id }) }}">{{ produit.auteur.nom }}
												{{ produit.auteur.prenom }}</a>
										</h3>

										<p class="card-text text-justify">{{ produit.description }}</p>
										<p class="card-text">{{ produit.prix }}
											â‚¬</p>
									</div>
								</div>

							{% endfor %}
						</div>
						<div class="text-center mb-4">
							<h3>Date de la command</h3>
							<p>{{ command.dateCommand ? command.dateCommand|date('Y-m-d H:i:s') : '' }}</p>
						</div>
					</div>
				{% endfor %}
			</section>

		{% endif %}
	</section>
	<div class="text-center my-4">
		<a href="{{ path('front_livre_new') }}" class="btn btn-outline-purple mx-1 p-3">
			<h4>Vendre un livre ðŸ“š
			</h4>
		</a>
	</div>
{% endblock %}
